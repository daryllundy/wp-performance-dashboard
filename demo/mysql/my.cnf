[mysqld]
# Performance Schema Configuration - Enhanced for Demo
performance_schema = ON
performance_schema_max_table_instances = 12500
performance_schema_max_table_handles = 4000
performance_schema_max_sql_text_length = 4096
performance_schema_max_digest_length = 4096

# Performance Schema Consumers - Enable all for comprehensive monitoring
performance_schema_consumer_events_stages_current = ON
performance_schema_consumer_events_stages_history = ON
performance_schema_consumer_events_stages_history_long = ON
performance_schema_consumer_events_statements_current = ON
performance_schema_consumer_events_statements_history = ON
performance_schema_consumer_events_statements_history_long = ON
performance_schema_consumer_events_waits_current = ON
performance_schema_consumer_events_waits_history = ON
performance_schema_consumer_events_waits_history_long = ON
performance_schema_consumer_global_instrumentation = ON
performance_schema_consumer_thread_instrumentation = ON

# Performance Schema Instruments - Enable MySQL statement/stage/wait instrumentation
performance_schema_instrument = 'stage/%=ON'
performance_schema_instrument = 'statement/%=ON'
performance_schema_instrument = 'wait/io/%=ON'
performance_schema_instrument = 'wait/lock/%=ON'

# Query Logging
slow_query_log = ON
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 1
log_queries_not_using_indexes = ON
log_slow_admin_statements = ON
log_slow_slave_statements = ON

general_log = ON
general_log_file = /var/log/mysql/general.log

# Binary Logging (for replication simulation)
log_bin = /var/log/mysql/mysql-bin.log
binlog_format = ROW
expire_logs_days = 7

# InnoDB Configuration for Performance Testing
innodb_buffer_pool_size = 256M
innodb_log_file_size = 64M
innodb_flush_log_at_trx_commit = 1
innodb_flush_method = O_DIRECT

# Connection Settings
max_connections = 200
max_connect_errors = 100000
connect_timeout = 60
wait_timeout = 28800
interactive_timeout = 28800

# Buffer Settings
key_buffer_size = 32M
max_allowed_packet = 64M
table_open_cache = 4000
sort_buffer_size = 2M
read_buffer_size = 2M
read_rnd_buffer_size = 8M
myisam_sort_buffer_size = 64M

# Temporary Tables
tmp_table_size = 32M
max_heap_table_size = 32M

# Thread Settings
thread_cache_size = 50
thread_stack = 256K

# MyISAM Settings
concurrent_insert = 2

# Additional Performance Monitoring Settings
log_output = TABLE,FILE
log_slow_admin_statements = ON
log_slow_slave_statements = ON
min_examined_row_limit = 100

# Information Schema and Performance Schema Optimization
information_schema_stats_expiry = 86400

# Enhanced Error Logging
log_error_verbosity = 3
log_timestamps = SYSTEM

# Replication and Binary Log Settings for Demo
server_id = 1
gtid_mode = ON
enforce_gtid_consistency = ON

# Security Settings for Demo Environment
skip_name_resolve = ON
local_infile = OFF

[mysql]
default_character_set = utf8mb4
auto_rehash = OFF

[client]
default_character_set = utf8mb4

[mysqldump]
single_transaction = ON
routines = ON
triggers = ON
